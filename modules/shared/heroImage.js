import{loadImage}from"./common.js";let imageSrcs={"":{src:"modules/shared/assets/me.jpg"},"#":{src:"modules/shared/assets/me.jpg"},"#about":{src:"modules/shared/assets/me.jpg"},"#journal":{src:"modules/shared/assets/me.jpg"},"#videos":[{src:"modules/shared/assets/ella.jpg",title1:"Ella",title2:"Sri Lanka"},{src:"modules/shared/assets/SteavensonFalls.jpg",title1:"Steavenson Falls",title2:"Marysville, Victoria"}],"#music":{src:"modules/shared/assets/me.jpg"}},transitionInProgress=!1,currentPage;async function updateHeroImage(s){if(!transitionInProgress&&s!==currentPage){currentPage=s;let r=imageSrcs[s];if(r){Array.isArray(r)&&(r=r[s=0,i=r.length-1,Math.floor(Math.random()*(i-s+1)+s)]);var i=r,s=i.src,n=await generateHash(s);let a=document.querySelector(".hero-image-container .hero-image-grid");if(0<a.children.length)if(a.children[a.children.length-1].id==="hero-image-"+n)return;transitionInProgress=!0;await loadImage(s);let t,e=document.createElement("div");e.classList.add("hero-image"),e.id="hero-image-"+n,e.style.backgroundImage=`url('${s}')`,i.title1&&i.title2&&((n=document.createElement("div")).classList.add("hero-image-title-bg"),e.appendChild(n),(s=document.createElement("div")).classList.add("hero-image-title-container"),(n=document.createElement("div")).innerText=i.title1,n.classList.add("title-1"),s.appendChild(n),(n=document.createElement("div")).innerText=i.title2,n.classList.add("title-2"),s.appendChild(n),e.appendChild(s)),e.addEventListener("animationend",e=>{"hero-image-scale"===e.animationName&&(t=null,2<a.children.length&&a.children[1].remove(),transitionInProgress=!1,updateHeroImage(window.location.hash))}),setTimeout(()=>a.appendChild(e),1e3)}}}let imageSrcHashes={};async function generateHash(e){var a;return imageSrcHashes[e]||(a=(new TextEncoder).encode(e),a=await window.crypto.subtle.digest("sha-1",a),a=Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join(""),imageSrcHashes[e]=a)}export{updateHeroImage};